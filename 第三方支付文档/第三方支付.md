#第三方支付
## 一、微信支付 [微信支付开发文档](https://pay.weixin.qq.com/wiki/doc/api/index.html)
###1. JSAPI支付(需要用户通过微信打开商户页面 因为要获取用户的openId)

- **业务流程:**

	这里直接从用户点击发起支付开始说明

	1. 用户发起支付请求
	2. 商户后台生成商户订单
	3. 调用微信[统一下单api](https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=9_1) 生成预付单并返回预付单信息(prepay_id) 给商户后台
	4. 商户后台生成JSAPI页面调用的支付参数并签名 然后返回客户端支付参数(prepay_id, paySign等)
	5. 用户点击发起支付 调用JSAPI接口请求支付
	6. 微信支付系统检查参数合法性和授权域权限并返回验证结果, 要求支付授权
	7. 用户确认支付 输入密码 提交支付授权
	8. 微信客户端验证授权
	9. 同时做出如下并行操作
	   
		1 异步通知商户后台支付结果
		2 商户后台告知微信通知处理结果
		3 返回支付结果给客户端并发微信消息提示
   
    10. 微信跳转回商户页面 并查询商户后台支付结果
    	
		1. 已经收到支付通知 直接返回支付结果
		2. 未收到的 调用[查询api](https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=9_2), 查询支付结果 并返回支付结果
	
	11. 商户页面后续操作

	**支付流程图:**

	
	![支付流程](./images/wx/jsapi/zflct.png)
  	
---

###2. H5支付

- **业务流程:**
 

